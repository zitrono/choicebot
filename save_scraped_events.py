#!/usr/bin/env python3
"""
Process and save the scraped event URLs from Verbier Festival website
"""

import json
import re

def process_scraped_data():
    """Process the scraped event URLs"""
    
    # The scraped data from Puppeteer
    scraped_raw = """{"totalFound": 152, "allEventUrls": ["https://www.verbierfestival.com/en/show/vf25-07-16-1900/", "https://www.verbierfestival.com/ical.php?date=2025-07-16&startTime=20250716T190000&endTime=20250716T201500&eventLocation=Salle des Combins&eventTitle=VF25 07 16 1900 Opening Ceremony&desc=https://www.verbierfestival.com/en/show/vf25-07-16-1900/", "https://www.verbierfestival.com/en/show/vf25-07-17-1100-150e-anniversaire-de-ravel-partie-1/", "https://www.verbierfestival.com/ical.php?date=2025-07-17&startTime=20250717T110000&endTime=20250717T130000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 17 1100 150E ANNIVERSAIRE DE RAVEL Partie 1&desc=https://www.verbierfestival.com/en/show/vf25-07-17-1100-150e-anniversaire-de-ravel-partie-1/", "https://www.verbierfestival.com/en/show/vf25-07-17-1530/", "https://www.verbierfestival.com/ical.php?date=2025-07-17&startTime=20250717T153000&endTime=20250717T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 17 1530 150E ANNIVERSAIRE DE RAVEL Partie 2&desc=https://www.verbierfestival.com/en/show/vf25-07-17-1530/", "https://www.verbierfestival.com/en/show/vf25-07-17-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-17&startTime=20250717T183000&endTime=20250717T201500&eventLocation=Salle des Combins&eventTitle=VF25 07 17 1830 VFO / BARBARA HANNIGAN&desc=https://www.verbierfestival.com/en/show/vf25-07-17-1830/", "https://www.verbierfestival.com/en/show/vf25-07-18-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-18&startTime=20250718T110000&endTime=20250718T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 18 1100 TJASHA GAFNER&desc=https://www.verbierfestival.com/en/show/vf25-07-18-1100/", "https://www.verbierfestival.com/en/show/vf25-07-18-laure-chan-la-tzoumaz/", "https://www.verbierfestival.com/en/show/vf25-07-18-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-18&startTime=20250718T183000&endTime=20250718T203000&eventLocation=Salle des Combins&eventTitle=VF25 07 18 1830 Maurice BÃ©jart Ballet&desc=https://www.verbierfestival.com/en/show/vf25-07-18-1830/", "https://www.verbierfestival.com/en/show/vf25-07-18-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-18&startTime=20250718T193000&endTime=20250718T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 18 1930 THIBAUT GARCIA&desc=https://www.verbierfestival.com/en/show/vf25-07-18-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-18-francesco-tristano/", "https://www.verbierfestival.com/ical.php?date=2025-07-18&startTime=20250718T213000&endTime=20250718T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 18 FRANCESCO TRISTANO&desc=https://www.verbierfestival.com/en/show/unltd25-07-18-francesco-tristano/", "https://www.verbierfestival.com/en/show/vf25-07-19-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-19&startTime=20250719T110000&endTime=20250719T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 19 1100 EKATERINA BONYUSHKINA&desc=https://www.verbierfestival.com/en/show/vf25-07-19-1100/", "https://www.verbierfestival.com/en/show/vf25-07-19-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-19&startTime=20250719T183000&endTime=20250719T204500&eventLocation=Salle des Combins&eventTitle=VF25 07 19 1830 VFCO / GÃBOR TAKÃCS-NAGY / KRISTÃ“F BARÃTI&desc=https://www.verbierfestival.com/en/show/vf25-07-19-1830/", "https://www.verbierfestival.com/en/show/vf25-07-19-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-19&startTime=20250719T193000&endTime=20250719T213000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 19 1930 SERGEI BABAYAN&desc=https://www.verbierfestival.com/en/show/vf25-07-19-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-19-youn-sun-nah-oxy-more/", "https://www.verbierfestival.com/ical.php?date=2025-07-19&startTime=20250719T213000&endTime=20250719T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 19 YOUN SUN NAH & OXY MORE&desc=https://www.verbierfestival.com/en/show/unltd25-07-19-youn-sun-nah-oxy-more/", "https://www.verbierfestival.com/en/show/vf25-07-20-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-20&startTime=20250720T110000&endTime=20250720T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 20 1100 LEONIDAS KAVAKOS / ILYA GRINGOLTS / ENSEMBLE APOLLON&desc=https://www.verbierfestival.com/en/show/vf25-07-20-1100/", "https://www.verbierfestival.com/en/show/vf25-07-20-1500/", "https://www.verbierfestival.com/ical.php?date=2025-07-20&startTime=20250720T150000&endTime=20250720T161500&eventLocation=Salle des Combins&eventTitle=VF25 07 20 1500 VFJO / ROBERTO GONZÃLEZ-MONJAS / JEAN-EFFLAM BAVOUZET&desc=https://www.verbierfestival.com/en/show/vf25-07-20-1500/", "https://www.verbierfestival.com/en/show/kids25-07-20-contes-musicaux-du-roi/", "https://www.verbierfestival.com/ical.php?date=2025-07-20&startTime=20250720T150000&endTime=20250720T160000&eventLocation=cinÃ©ma de verbier&eventTitle=KIDS25 07 20 CONTES MUSICAUX DU ROI&desc=https://www.verbierfestival.com/en/show/kids25-07-20-contes-musicaux-du-roi/", "https://www.verbierfestival.com/en/show/vf25-07-20-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-20&startTime=20250720T193000&endTime=20250720T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 20 1930 THOMAS HAMPSON / KSENIJA SIDOROVA&desc=https://www.verbierfestival.com/en/show/vf25-07-20-1930/", "https://www.verbierfestival.com/en/show/vf25-07-21-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-21&startTime=20250721T110000&endTime=20250721T183000&eventLocation=Salle des Combins&eventTitle=VF25 07 21 1830 EVGENY KISSIN&desc=https://www.verbierfestival.com/en/show/vf25-07-21-1830/", "https://www.verbierfestival.com/en/show/vf25-07-21-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-21&startTime=20250721T110000&endTime=20250721T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 21 1100 RAPHAÃ‹L FEUILLÃ‚TRE&desc=https://www.verbierfestival.com/en/show/vf25-07-21-1100/", "https://www.verbierfestival.com/en/show/vf25-07-21-1530/", "https://www.verbierfestival.com/ical.php?date=2025-07-21&startTime=20250721T153000&endTime=20250721T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 21 1530 Academy Presents I&desc=https://www.verbierfestival.com/en/show/vf25-07-21-1530/", "https://www.verbierfestival.com/en/show/vf25-07-21-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-21&startTime=20250721T193000&endTime=20250721T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 21 1930 Rencontres InÃ©dites I&desc=https://www.verbierfestival.com/en/show/vf25-07-21-1930/", "https://www.verbierfestival.com/en/show/vf25-07-22-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-22&startTime=20250722T110000&endTime=20250722T183000&eventLocation=Salle des Combins&eventTitle=VF25 07 22 1830 VFCO / KLAUS MÃ„KELÃ„&desc=https://www.verbierfestival.com/en/show/vf25-07-22-1830/", "https://www.verbierfestival.com/en/show/vf25-07-22-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-22&startTime=20250722T110000&endTime=20250722T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 22 1100 ANTOINE TAMESTIT / JULIEN QUENTIN&desc=https://www.verbierfestival.com/en/show/vf25-07-22-1100/", "https://www.verbierfestival.com/en/show/vf25-07-22-1530/", "https://www.verbierfestival.com/ical.php?date=2025-07-22&startTime=20250722T153000&endTime=20250722T164500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 22 1530 MINSOO SOHN&desc=https://www.verbierfestival.com/en/show/vf25-07-22-1530/", "https://www.verbierfestival.com/en/show/vf25-07-22-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-22&startTime=20250722T193000&endTime=20250722T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 22 1930 YUNCHAN LIM&desc=https://www.verbierfestival.com/en/show/vf25-07-22-1930/", "https://www.verbierfestival.com/en/show/vf25-07-23-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-23&startTime=20250723T110000&endTime=20250723T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 23 1100 Rencontres InÃ©dites II&desc=https://www.verbierfestival.com/en/show/vf25-07-23-1100/", "https://www.verbierfestival.com/en/show/unltd25-07-23-nicolas-namoradze-neurorecital/", "https://www.verbierfestival.com/ical.php?date=2025-07-23&startTime=20250723T143000&endTime=20250723T160000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 23 NICOLAS NAMORADZE NEURORECITAL&desc=https://www.verbierfestival.com/en/show/unltd25-07-23-nicolas-namoradze-neurorecital/", "https://www.verbierfestival.com/en/show/vf25-07-23-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-23&startTime=20250723T173000&endTime=20250723T183000&eventLocation=Salle des Combins&eventTitle=VF25 07 23 1830 DANIIL TRIFONOV&desc=https://www.verbierfestival.com/en/show/vf25-07-23-1830/", "https://www.verbierfestival.com/en/show/vf25-23-07-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-23&startTime=20250723T193000&endTime=20250723T213000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 23 1930 LEONIDAS KAVAKOS / IASON MARMARAS&desc=https://www.verbierfestival.com/en/show/vf25-23-07-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-23-unravelled/", "https://www.verbierfestival.com/ical.php?date=2025-07-23&startTime=20250723T213000&endTime=20250723T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 23 UNRAVELLED&desc=https://www.verbierfestival.com/en/show/unltd25-07-23-unravelled/", "https://www.verbierfestival.com/en/show/vf25-07-24-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-24&startTime=20250724T110000&endTime=20250724T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 24 1100 MAO FUJITA&desc=https://www.verbierfestival.com/en/show/vf25-07-24-1100/", "https://www.verbierfestival.com/en/show/vf25-07-24-1530-academy-presents-ii/", "https://www.verbierfestival.com/ical.php?date=2025-07-24&startTime=20250724T153000&endTime=20250724T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 24 1530 Academy Presents II&desc=https://www.verbierfestival.com/en/show/vf25-07-24-1530-academy-presents-ii/", "https://www.verbierfestival.com/en/show/vf25-07-24-galilee-quartet-la-tzoumaz/", "https://www.verbierfestival.com/en/show/vf25-07-24-1930-2/", "https://www.verbierfestival.com/ical.php?date=2025-07-24&startTime=20250724T193000&endTime=20250724T211500&eventLocation=cinÃ©ma de verbier&eventTitle=VF25 07 24 1930 RENAUD CAPUÃ‡ON / GAUTIER CAPUÃ‡ON / MARTHA ARGERICH&desc=https://www.verbierfestival.com/en/show/vf25-07-24-1930-2/", "https://www.verbierfestival.com/en/show/vf25-07-24-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-24&startTime=20250724T193000&endTime=20250724T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 24 1930 RENAUD CAPUÃ‡ON / GAUTIER CAPUÃ‡ON / MARTHA ARGERICH&desc=https://www.verbierfestival.com/en/show/vf25-07-24-1930/", "https://www.verbierfestival.com/en/show/vf25-07-25-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-25&startTime=20250725T110000&endTime=20250725T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 25 1100 ROMAN BORISOV&desc=https://www.verbierfestival.com/en/show/vf25-07-25-1100/", "https://www.verbierfestival.com/en/show/vf25-07-25-1530/", "https://www.verbierfestival.com/ical.php?date=2025-07-25&startTime=20250725T153000&endTime=20250725T164500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 25 1530 YUNCHAN LIM / MINSOO SOHN&desc=https://www.verbierfestival.com/en/show/vf25-07-25-1530/", "https://www.verbierfestival.com/en/show/vf25-07-25-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-25&startTime=20250725T183000&endTime=20250725T203000&eventLocation=Salle des Combins&eventTitle=VF25 07 25 1830 Rencontres InÃ©dites III&desc=https://www.verbierfestival.com/en/show/vf25-07-25-1830/", "https://www.verbierfestival.com/en/show/vf25-25-07-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-25&startTime=20250725T193000&endTime=20250725T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 25 1930 BENJAMIN APPL / JAMES BAILLIEU&desc=https://www.verbierfestival.com/en/show/vf25-25-07-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-25-the-amy-winehouse-band/", "https://www.verbierfestival.com/ical.php?date=2025-07-25&startTime=20250725T213000&endTime=20250725T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 25 THE AMY WINEHOUSE BAND&desc=https://www.verbierfestival.com/en/show/unltd25-07-25-the-amy-winehouse-band/", "https://www.verbierfestival.com/en/show/vf25-07-26-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T110000&endTime=20250726T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 26 1100 Rencontres InÃ©dites IV&desc=https://www.verbierfestival.com/en/show/vf25-07-26-1100/", "https://www.verbierfestival.com/en/show/vf25-07-26-1500/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T150000&endTime=20250726T161500&eventLocation=Salle des Combins&eventTitle=VF25 07 26 1500 VFJO / GÃBOR TAKÃCS-NAGY / ANASTASIA KOBEKINA&desc=https://www.verbierfestival.com/en/show/vf25-07-26-1500/", "https://www.verbierfestival.com/en/show/kids25-07-26-spectacle-storytellers/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T150000&endTime=20250726T154500&eventLocation=cinÃ©ma de verbier&eventTitle=KIDS25 07 26 SPECTACLE STORYTELLERS&desc=https://www.verbierfestival.com/en/show/kids25-07-26-spectacle-storytellers/", "https://www.verbierfestival.com/en/show/vf25-07-26-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T183000&endTime=20250726T204500&eventLocation=Salle des Combins&eventTitle=VF25 07 26 1830 Messe en si mineur de J.S. Bach&desc=https://www.verbierfestival.com/en/show/vf25-07-26-1830/", "https://www.verbierfestival.com/en/show/vf25-07-26-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T193000&endTime=20250726T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 26 1930 Rencontres InÃ©dites V&desc=https://www.verbierfestival.com/en/show/vf25-07-26-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-26-wooden-elephant/", "https://www.verbierfestival.com/ical.php?date=2025-07-26&startTime=20250726T213000&endTime=20250726T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 26 WOODEN ELEPHANT&desc=https://www.verbierfestival.com/en/show/unltd25-07-26-wooden-elephant/", "https://www.verbierfestival.com/en/show/vf25-27-07-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-27&startTime=20250727T110000&endTime=20250727T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 27 1100 FRÃ–ST INTERLACED&desc=https://www.verbierfestival.com/en/show/vf25-27-07-1100/", "https://www.verbierfestival.com/en/show/vf25-07-27-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-27&startTime=20250727T183000&endTime=20250727T203000&eventLocation=Salle des Combins&eventTitle=VF25 07 27 1830 VFO / MANFRED HONECK / GAUTIER CAPUÃ‡ON&desc=https://www.verbierfestival.com/en/show/vf25-07-27-1830/", "https://www.verbierfestival.com/en/show/vf25-07-27-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-27&startTime=20250727T193000&endTime=20250727T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 27 1930 Rencontres InÃ©dites VI&desc=https://www.verbierfestival.com/en/show/vf25-07-27-1930/", "https://www.verbierfestival.com/en/show/vf25-07-28-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-28&startTime=20250728T110000&endTime=20250728T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 28 1100 RANDALL GOOSBY / JULIEN QUENTIN&desc=https://www.verbierfestival.com/en/show/vf25-07-28-1100/", "https://www.verbierfestival.com/en/show/vf-25-07-28-1530/", "https://www.verbierfestival.com/ical.php?date=2025-07-28&startTime=20250728T153000&endTime=20250728T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 28 1530 MARC BOUCHKOV / MÃTÃ‰ SZÃœCS / BRYAN CHENG / JULIEN QUENTIN&desc=https://www.verbierfestival.com/en/show/vf-25-07-28-1530/", "https://www.verbierfestival.com/en/show/vf25-28-07-1930-2/", "https://www.verbierfestival.com/ical.php?date=2025-07-28&startTime=20250728T193000&endTime=20250728T210000&eventLocation=cinÃ©ma de verbier&eventTitle=VF25 07 28 1930 MISCHA MAISKY / MARTHA ARGERICH&desc=https://www.verbierfestival.com/en/show/vf25-28-07-1930-2/", "https://www.verbierfestival.com/en/show/vf25-28-07-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-28&startTime=20250728T193000&endTime=20250728T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 28 1930 MISCHA MAISKY / MARTHA ARGERICH&desc=https://www.verbierfestival.com/en/show/vf25-28-07-1930/", "https://www.verbierfestival.com/en/show/vf25-07-29/", "https://www.verbierfestival.com/ical.php?date=2025-07-29&startTime=20250729T110000&endTime=20250729T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 29 1100 JOHAN DALENE / JULIEN QUENTIN&desc=https://www.verbierfestival.com/en/show/vf25-07-29/", "https://www.verbierfestival.com/en/show/vf25-07-29-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-29&startTime=20250729T183000&endTime=20250729T204500&eventLocation=Salle des Combins&eventTitle=VF25 07 29 1830  50E ANNIVERSAIRE DE LA DISPARITION CHOSTAKOVICH&desc=https://www.verbierfestival.com/en/show/vf25-07-29-1830/", "https://www.verbierfestival.com/en/show/vf25-07-29-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-29&startTime=20250729T193000&endTime=20250729T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 29 1930 Rencontres InÃ©dites VII&desc=https://www.verbierfestival.com/en/show/vf25-07-29-1930/", "https://www.verbierfestival.com/en/show/unltd25-07-29-sheku-kanneh-mason-harry-baker/", "https://www.verbierfestival.com/ical.php?date=2025-07-29&startTime=20250729T213000&endTime=20250729T230000&eventLocation=cinÃ©ma de verbier&eventTitle=UNLTD25 07 29 SHEKU KANNEH-MASON & HARRY BAKER&desc=https://www.verbierfestival.com/en/show/unltd25-07-29-sheku-kanneh-mason-harry-baker/", "https://www.verbierfestival.com/en/show/vf25-07-30-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-30&startTime=20250730T110000&endTime=20250730T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 30 1100 ANASTASIA KOBEKINA / ISATA KANNEH-MASON&desc=https://www.verbierfestival.com/en/show/vf25-07-30-1100/", "https://www.verbierfestival.com/en/show/kids25-07-30-little-sheku-and-the-animal-orchestra/", "https://www.verbierfestival.com/ical.php?date=2025-07-30&startTime=20250730T143000&endTime=20250730T153000&eventLocation=chalet orny&eventTitle=KIDS25 07 30 LITTLE SHEKU AND THE ANIMAL ORCHESTRA&desc=https://www.verbierfestival.com/en/show/kids25-07-30-little-sheku-and-the-animal-orchestra/", "https://www.verbierfestival.com/en/show/vf25-07-30-1530-academy-presents-iii/", "https://www.verbierfestival.com/ical.php?date=2025-07-30&startTime=20250730T153000&endTime=20250730T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 30 1530 Academy Presents III&desc=https://www.verbierfestival.com/en/show/vf25-07-30-1530-academy-presents-iii/", "https://www.verbierfestival.com/en/show/vf25-07-30-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-30&startTime=20250730T183000&endTime=20250730T203000&eventLocation=Salle des Combins&eventTitle=VF25 07 30 1830&desc=https://www.verbierfestival.com/en/show/vf25-07-30-1830/", "https://www.verbierfestival.com/en/show/vf25-07-30-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-30&startTime=20250730T193000&endTime=20250730T213000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 30 1930 VIKTORIA POSTNIKOVA / EKATERINA SEMENCHUK / MAHARRAM HUSEYNOV&desc=https://www.verbierfestival.com/en/show/vf25-07-30-1930/", "https://www.verbierfestival.com/en/show/vf25-07-31-1100/", "https://www.verbierfestival.com/ical.php?date=2025-07-31&startTime=20250731T110000&endTime=20250731T124500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 31 1100 BORIS BROVTSYN / JULIEN QUENTIN&desc=https://www.verbierfestival.com/en/show/vf25-07-31-1100/", "https://www.verbierfestival.com/en/show/vf25-07-31-1830/", "https://www.verbierfestival.com/ical.php?date=2025-07-31&startTime=20250731T183000&endTime=20250731T203000&eventLocation=Salle des Combins&eventTitle=VF25 07 31 1830 VFO / TEODOR CURRENTZIS / ALEXANDRE KANTOROW&desc=https://www.verbierfestival.com/en/show/vf25-07-31-1830/", "https://www.verbierfestival.com/en/show/vf25-07-31-1930/", "https://www.verbierfestival.com/ical.php?date=2025-07-31&startTime=20250731T193000&endTime=20250731T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 07 31 1930 ALEXANDER MALOFEEV&desc=https://www.verbierfestival.com/en/show/vf25-07-31-1930/", "https://www.verbierfestival.com/en/show/vf25-08-01-1100/", "https://www.verbierfestival.com/ical.php?date=2025-08-01&startTime=20250801T110000&endTime=20250801T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 01 1100 QUATUOR Ã‰BÃˆNE / MARTIN FRÃ–ST&desc=https://www.verbierfestival.com/en/show/vf25-08-01-1100/", "https://www.verbierfestival.com/en/show/vf25-08-01-1530-academy-presents-iv/", "https://www.verbierfestival.com/ical.php?date=2025-08-01&startTime=20250801T153000&endTime=20250801T163000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 01 1530 Academy Presents IV&desc=https://www.verbierfestival.com/en/show/vf25-08-01-1530-academy-presents-iv/", "https://www.verbierfestival.com/en/show/kids25-08-01-the-fisherman-and-the-fish/", "https://www.verbierfestival.com/ical.php?date=2025-08-01&startTime=20250801T160000&endTime=20250801T171500&eventLocation=chalet orny&eventTitle=KIDS25 08 01 THE FISHERMAN AND THE FISH&desc=https://www.verbierfestival.com/en/show/kids25-08-01-the-fisherman-and-the-fish/", "https://www.verbierfestival.com/en/show/vf25-01-08-1830/", "https://www.verbierfestival.com/ical.php?date=2025-08-01&startTime=20250801T183000&endTime=20250801T200000&eventLocation=Salle des Combins&eventTitle=VF25 08 01 1830 BRAD MEHLDAU TRIO&desc=https://www.verbierfestival.com/en/show/vf25-01-08-1830/", "https://www.verbierfestival.com/en/show/vf25-01-08-1930/", "https://www.verbierfestival.com/ical.php?date=2025-08-01&startTime=20250801T193000&endTime=20250801T210000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 01 1930 Rencontres InÃ©dites VIII&desc=https://www.verbierfestival.com/en/show/vf25-01-08-1930/", "https://www.verbierfestival.com/en/show/vf25-08-02-1100/", "https://www.verbierfestival.com/ical.php?date=2025-08-02&startTime=20250802T110000&endTime=20250802T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 02 1100 Academy Presents V&desc=https://www.verbierfestival.com/en/show/vf25-08-02-1100/", "https://www.verbierfestival.com/en/show/vf-talk-25-08-02-jacqueline-du-pre-genie-et-tragedie/", "https://www.verbierfestival.com/ical.php?date=2025-08-02&startTime=20250802T163000&endTime=20250802T180000&eventLocation=cinÃ©ma de verbier&eventTitle=VF TALK 25 08 02 JACQUELINE DU PRÃ‰ : GÃ‰NIE ET TRAGÃ‰DIE&desc=https://www.verbierfestival.com/en/show/vf-talk-25-08-02-jacqueline-du-pre-genie-et-tragedie/", "https://www.verbierfestival.com/en/show/vf25-08-02-1830/", "https://www.verbierfestival.com/ical.php?date=2025-08-02&startTime=20250802T183000&endTime=20250802T201500&eventLocation=Salle des Combins&eventTitle=VF25 08 02 1830 VFCO / TEODOR CURRENTZIS / MARC BOUCHKOV&desc=https://www.verbierfestival.com/en/show/vf25-08-02-1830/", "https://www.verbierfestival.com/en/show/vf25-08-02-1930/", "https://www.verbierfestival.com/ical.php?date=2025-08-02&startTime=20250802T193000&endTime=20250802T211500&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 02 1930 DANIEL LOZAKOVICH / EDGAR MOREAU / BEHZOD ABDURAIMOV&desc=https://www.verbierfestival.com/en/show/vf25-08-02-1930/", "https://www.verbierfestival.com/en/show/vf25-08-03-1100-academy-presents-vi/", "https://www.verbierfestival.com/ical.php?date=2025-08-03&startTime=20250803T110000&endTime=20250803T123000&eventLocation=Ã‰glise de Verbier Station&eventTitle=VF25 08 03 1100 Academy Presents VI&desc=https://www.verbierfestival.com/en/show/vf25-08-03-1100-academy-presents-vi/", "https://www.verbierfestival.com/en/show/vf25-03-08-1400/", "https://www.verbierfestival.com/ical.php?date=2025-08-03&startTime=20250803T140000&endTime=20250803T163000&eventLocation=Salle des Combins&eventTitle=VF25 08 03 1400 TCHAÃKOVSKI EugÃ¨ne OnÃ©guine&desc=https://www.verbierfestival.com/en/show/vf25-03-08-1400/", "https://www.verbierfestival.com/en/show/vf25-08-03-1830/", "https://www.verbierfestival.com/ical.php?date=2025-08-03&startTime=20250803T183000&endTime=20250803T204500&eventLocation=Salle des Combins&eventTitle=VF25 08 03 1830 VFO / PAAVO JÃ„RVI / KHATIA BUNIATISHVILI&desc=https://www.verbierfestival.com/en/show/vf25-08-03-1830/"]}"""
    
    data = json.loads(scraped_raw)
    
    # Process and deduplicate URLs
    event_urls = []
    seen_ids = set()
    
    for url in data['allEventUrls']:
        # Only keep actual event URLs (not ical links)
        if '/en/show/' in url and not url.startswith('https://www.verbierfestival.com/ical.php'):
            # Extract event ID
            match = re.search(r'/show/([^/]+)/?', url)
            if match:
                event_id = match.group(1)
                
                if event_id not in seen_ids:
                    seen_ids.add(event_id)
                    
                    # Parse date and time from event ID
                    date = ""
                    time = ""
                    date_match = re.search(r'vf25-(\d{2})-(\d{2})-(\d{4})', event_id)
                    if date_match:
                        month, day, time_str = date_match.groups()
                        date = f"{day}.{month}"
                        time = f"{time_str[:2]}:{time_str[2:]}"
                    
                    event_urls.append({
                        'event_id': event_id,
                        'url': url,
                        'date': date,
                        'time': time
                    })
    
    return event_urls

def main():
    print("=" * 80)
    print("PROCESSING SCRAPED EVENT URLs")
    print("=" * 80)
    
    events = process_scraped_data()
    
    print(f"\nðŸ“Š SCRAPED DATA SUMMARY:")
    print(f"  â€¢ Total unique events found: {len(events)}")
    
    # Group by date
    by_date = {}
    for event in events:
        date = event['date'] or 'unknown'
        if date not in by_date:
            by_date[date] = []
        by_date[date].append(event)
    
    print(f"\nðŸ“… EVENTS BY DATE:")
    dates_sorted = sorted([d for d in by_date.keys() if d != 'unknown'])
    for date in dates_sorted[:5]:
        print(f"  â€¢ {date}: {len(by_date[date])} events")
    if len(dates_sorted) > 5:
        print(f"  ... and {len(dates_sorted) - 5} more dates")
    
    # Save to JSON
    output_path = '/Users/zitrono/dev/tmp/verbier/scraped_events.json'
    with open(output_path, 'w') as f:
        json.dump(events, f, indent=2, ensure_ascii=False)
    
    print(f"\nâœ… Saved {len(events)} unique event URLs to {output_path}")
    
    # Show sample
    print(f"\nðŸŽ¯ SAMPLE EVENTS:")
    for event in events[:5]:
        print(f"  â€¢ {event['event_id']}")
        print(f"    Date: {event['date']} Time: {event['time']}")
        print(f"    URL: {event['url']}")
    
    print("=" * 80)

if __name__ == "__main__":
    main()